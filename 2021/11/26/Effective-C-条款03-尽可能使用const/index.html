<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jarvissky.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const1ã€const å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡å°±åƒä¸€ä¸ªé­”å’’ï¼Œä½ ç»™ä¸€ä¸ªå§‘å¨˜ä¸‹ä¸€ä¸ªé­”å’’ï¼Œè§„å®šå¥¹åªèƒ½çˆ±ä½ ä¸€ä¸ªäººï¼ˆæœ‰ç‚¹é‚ªæ¶ğŸ˜ˆã€‚ã€‚ã€‚ï¼‰æˆ–è€…è¯´ï¼Œconst ä¿®é¥°çš„å¯¹è±¡éƒ½æ˜¯å•çº¯çš„å§‘å¨˜ï¼Œä¸€æ—¦çˆ±ä¸Šä½ ï¼Œåªçˆ±ä½ ä¸€ä¸ªäººï¼Œæ°¸è¿œå˜å¿ƒã€‚ 2ã€const å¯ä»¥ç”¨åœ¨å“ªé‡Œå¯ä»¥åœ¨classå¤–éƒ¨ä¿®é¥° globalæˆ– namespaceä½œç”¨åŸŸä¸­çš„å¸¸é‡ã€‚å¯ä»¥ä¿®é¥°æ–‡">
<meta property="og:type" content="article">
<meta property="og:title" content="Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const">
<meta property="og:url" content="http://jarvissky.com/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/index.html">
<meta property="og:site_name" content="Jarvisçš„å¤©ç©º">
<meta property="og:description" content="Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const1ã€const å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡å°±åƒä¸€ä¸ªé­”å’’ï¼Œä½ ç»™ä¸€ä¸ªå§‘å¨˜ä¸‹ä¸€ä¸ªé­”å’’ï¼Œè§„å®šå¥¹åªèƒ½çˆ±ä½ ä¸€ä¸ªäººï¼ˆæœ‰ç‚¹é‚ªæ¶ğŸ˜ˆã€‚ã€‚ã€‚ï¼‰æˆ–è€…è¯´ï¼Œconst ä¿®é¥°çš„å¯¹è±¡éƒ½æ˜¯å•çº¯çš„å§‘å¨˜ï¼Œä¸€æ—¦çˆ±ä¸Šä½ ï¼Œåªçˆ±ä½ ä¸€ä¸ªäººï¼Œæ°¸è¿œå˜å¿ƒã€‚ 2ã€const å¯ä»¥ç”¨åœ¨å“ªé‡Œå¯ä»¥åœ¨classå¤–éƒ¨ä¿®é¥° globalæˆ– namespaceä½œç”¨åŸŸä¸­çš„å¸¸é‡ã€‚å¯ä»¥ä¿®é¥°æ–‡">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-11-26T14:41:28.000Z">
<meta property="article:modified_time" content="2021-11-26T14:43:59.458Z">
<meta property="article:author" content="Jarvis">
<meta property="article:tag" content="effective C++">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://jarvissky.com/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const | Jarvisçš„å¤©ç©º</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Jarvisçš„å¤©ç©º" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jarvisçš„å¤©ç©º</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">é—²äº‘é‡é¹¤</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">6</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">6</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://jarvissky.com/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jarvis">
      <meta itemprop="description" content="å¹²é¥­ç¡è§‰æ’¸ä»£ç ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jarvisçš„å¤©ç©º">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-11-26 22:41:28 / ä¿®æ”¹æ—¶é—´ï¼š22:43:59" itemprop="dateCreated datePublished" datetime="2021-11-26T22:41:28+08:00">2021-11-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/effective-c/" itemprop="url" rel="index"><span itemprop="name">effective c++</span></a>
                </span>
            </span>

          
            <span id="/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/" class="post-meta-item leancloud_visitors" data-flag-title="Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>7.6k</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Effective-C-æ¡æ¬¾03-å°½å¯èƒ½ä½¿ç”¨const"><a href="#Effective-C-æ¡æ¬¾03-å°½å¯èƒ½ä½¿ç”¨const" class="headerlink" title="Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const"></a>Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const</h1><h2 id="1ã€const-å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡"><a href="#1ã€const-å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡" class="headerlink" title="1ã€const å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡"></a>1ã€const å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡</h2><p>å°±åƒä¸€ä¸ªé­”å’’ï¼Œä½ ç»™ä¸€ä¸ªå§‘å¨˜ä¸‹ä¸€ä¸ªé­”å’’ï¼Œè§„å®šå¥¹åªèƒ½çˆ±ä½ ä¸€ä¸ªäººï¼ˆæœ‰ç‚¹é‚ªæ¶ğŸ˜ˆã€‚ã€‚ã€‚ï¼‰<br>æˆ–è€…è¯´ï¼Œconst ä¿®é¥°çš„å¯¹è±¡éƒ½æ˜¯å•çº¯çš„å§‘å¨˜ï¼Œä¸€æ—¦çˆ±ä¸Šä½ ï¼Œåªçˆ±ä½ ä¸€ä¸ªäººï¼Œæ°¸è¿œå˜å¿ƒã€‚</p>
<h2 id="2ã€const-å¯ä»¥ç”¨åœ¨å“ªé‡Œ"><a href="#2ã€const-å¯ä»¥ç”¨åœ¨å“ªé‡Œ" class="headerlink" title="2ã€const å¯ä»¥ç”¨åœ¨å“ªé‡Œ"></a>2ã€const å¯ä»¥ç”¨åœ¨å“ªé‡Œ</h2><p>å¯ä»¥åœ¨classå¤–éƒ¨ä¿®é¥° globalæˆ– namespaceä½œç”¨åŸŸä¸­çš„å¸¸é‡ã€‚<br>å¯ä»¥ä¿®é¥°æ–‡ä»¶ï¼Œå‡½æ•°ï¼Œæˆ–åŒºå—ä½œç”¨åŸŸï¼ˆblock scopeï¼‰ ä¸­è¢«å£°æ˜ä¸ºstaticçš„å¯¹è±¡ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨å®ƒä¿®é¥°classes å†…éƒ¨çš„statiså’Œno-staticæˆå‘˜å˜é‡ã€‚<br>é¢å¯¹æŒ‡é’ˆï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å‡ºæŒ‡é’ˆè‡ªèº«ã€æŒ‡é’ˆæ‰€æŒ‡ç‰©ï¼Œæˆ–è€…ä¸¤è€…éƒ½æ˜¯cosnt.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">char greeting[] &#x3D; &quot;Hello&quot;; </span><br><span class="line">char *p &#x3D; greeting;           &#x2F;&#x2F;non-const pointer, non-const data</span><br><span class="line">const char *p &#x3D; greeting;  &#x2F;&#x2F;non-const pointer, const data</span><br><span class="line">char *const p &#x3D; greeting;  &#x2F;&#x2F;const pointer, non-const data</span><br><span class="line">const char* const p &#x3D; greeting;  &#x2F;&#x2F;const pointer, const data</span><br></pre></td></tr></table></figure>
<p>const è¯­æ³•è™½ç„¶å˜åŒ–å¤šç«¯ï¼Œä½†å¹¶ä¸è«æµ‹é«˜æ·±ã€‚<br><strong>å¦‚æœå…³é”®å­—const å‡ºç°åœ¨*å·¦è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©æ˜¯å¸¸é‡</strong><br><strong>å¦‚æœå…³é”®å­—const å‡ºç°åœ¨*å³è¾¹ï¼Œè¡¨ç¤ºæŒ‡é’ˆè‡ªèº«æ˜¯å¸¸é‡</strong><br><strong>å¦‚æœå…³é”®å­—const å‡ºç°åœ¨*å·¦å³ä¸¤è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©å’ŒæŒ‡é’ˆéƒ½æ˜¯å¸¸é‡</strong><br>å¦‚æœè¢«æŒ‡ç‰©æ˜¯å¸¸é‡ï¼Œæœ‰äº›ç¨‹åºå‘˜ä¼šå°†å…³é”®å­—const å†™åœ¨ç±»å‹ä¹‹å‰ï¼Œæœ‰äº›äººä¼šæŠŠå®ƒå†™åœ¨ç±»å‹ä¹‹åã€æ˜Ÿå·ä¹‹å‰ã€‚ä¸¤ç§å†™æ³•çš„æ„ä¹‰ç›¸åŒï¼Œæ‰€ä»¥ä¸‹åˆ—ä¸¤ä¸ªå‡½æ•°æ¥å—çš„å‡½æ•°ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void f1(const Widget *pw);  &#x2F;&#x2F;f1è·å¾—ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¸¸é‡çš„ï¼ˆä¸å˜çš„ï¼‰widgetå¯¹è±¡</span><br><span class="line">void f2(Widget cosnt *pw);  &#x2F;&#x2F;f2 ä¹Ÿæ˜¯</span><br></pre></td></tr></table></figure>
<span id="more"></span>

<h2 id="3ã€STLè¿­ä»£å™¨-const"><a href="#3ã€STLè¿­ä»£å™¨-const" class="headerlink" title="3ã€STLè¿­ä»£å™¨ const"></a>3ã€STLè¿­ä»£å™¨ const</h2><p>STLè¿­ä»£å™¨ç³»ä»¥æŒ‡é’ˆä¸ºæ ¹æ®å¡‘æ¨¡å‡ºæ¥ï¼Œæ‰€ä»¥è¿­ä»£å™¨çš„ä½œç”¨å°±åƒä¸ªT<em>æŒ‡é’ˆã€‚å£°æ˜è¿­ä»£å™¨const å°±åƒå£°æ˜æŒ‡é’ˆä¸ºconst ä¸€æ ·ï¼ˆå³å£°æ˜ä¸€ä¸ª T</em> cosnt æŒ‡é’ˆï¼‰ï¼Œè¡¨ç¤ºè¿™ä¸ªè¿­ä»£å™¨ä¸å¾—æŒ‡å‘ä¸åŒçš„ä¸œè¥¿ï¼Œä½†å®ƒæ‰€æŒ‡çš„ä¸œè¥¿çš„å€¼æ˜¯å¯ä»¥æ”¹åŠ¨çš„ã€‚å¦‚æœä½ å¸Œæœ›è¿­ä»£å™¨æ‰€æŒ‡çš„ä¸œè¥¿ä¸å¯è¢«æ”¹åŠ¨ï¼ˆå³å¸Œæœ›STLæ¨¡æ‹Ÿä¸€ä¸ªconst T*æŒ‡é’ˆï¼‰ï¼Œä½ éœ€è¦çš„æ˜¯const_iterator:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;int&gt; vec;</span><br><span class="line">Â·Â·Â·</span><br><span class="line">const std::vector&lt;int&gt;::iterator iter &#x3D; vec.begin(); &#x2F;&#x2F;iter çš„ä½œç”¨åƒä¸ª T* const</span><br><span class="line">*iter &#x3D; 10;  &#x2F;&#x2F;  æ²¡é—®é¢˜ï¼Œæ”¹å˜ iteræ‰€æŒ‡ç‰©</span><br><span class="line">++iter;      &#x2F;&#x2F;é”™è¯¯ï¼iter æ˜¯const</span><br><span class="line">std::vector&lt;int&gt; ::const_iterator cIter &#x3D; vec.begin();&#x2F;&#x2F;cIterçš„ä½œç”¨åƒä¸ªconst T*</span><br><span class="line">*cIter &#x3D; 10;  &#x2F;&#x2F;  é”™è¯¯ï¼ *cIter æ˜¯const</span><br><span class="line">++cIter;      &#x2F;&#x2F;  æ²¡é—®é¢˜ï¼Œæ”¹å˜cIter</span><br></pre></td></tr></table></figure>
<p>constæœ€å…·å¨åŠ›çš„ç”¨æ³•æ˜¯é¢å¯¹å‡½æ•°å£°æ˜æ—¶çš„åº”ç”¨ã€‚åœ¨ä¸€ä¸ªå‡½æ•°å£°æ˜å¼å†…ï¼Œconstå¯ä»¥å’Œå‡½æ•°è¿”å›å€¼ã€å„å‚æ•°ã€å‡½æ•°è‡ªèº«ï¼ˆå¦‚æœæ˜¯æˆå‘˜å‡½æ•°ï¼‰äº§ç”Ÿå…³è”ã€‚</p>
<h2 id="4ã€const-è¿”å›å€¼"><a href="#4ã€const-è¿”å›å€¼" class="headerlink" title="4ã€const è¿”å›å€¼"></a>4ã€const è¿”å›å€¼</h2><p>ä»¤å‡½æ•°è¿”å›ä¸€ä¸ªå¸¸é‡å€¼ï¼Œå¾€å¾€å¯ä»¥é™ä½å› å®¢æˆ·é”™è¯¯è€Œé€ æˆçš„æ„å¤–ï¼Œè€Œåˆä¸è‡³äºæ”¾å¼ƒå®‰å…¨æ€§å’Œé«˜æ•ˆæ€§ã€‚<br>ä¾‹å¦‚ operator * å£°æ˜å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class Rational&#123;   Â·Â·Â·   &#125;;</span><br><span class="line">const Rational operator* (const Rational&amp; lhs, const Rational &amp;rhs);</span><br></pre></td></tr></table></figure>
<p>ä¸è¦è¯§å¼‚ï¼Œä¸ºä»€ä¹ˆå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªcosntå¯¹è±¡ã€‚å› ä¸ºå¦‚æœä¸è¿™æ ·åšçš„è¯ï¼Œå®¢æˆ·å¯èƒ½è¿™æ ·åšï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Rational a, b, c;</span><br><span class="line">Â·Â·Â·</span><br><span class="line">(a*b) &#x3D; c;  &#x2F;&#x2F;åœ¨a * bçš„æˆæœä¸Šè°ƒç”¨ operator&#x3D;</span><br></pre></td></tr></table></figure>

<p>å¯¹ä¸¤ä¸ªæ•°çš„ä¹˜ç§¯åšèµ‹å€¼ï¼Œä¸€èˆ¬æ˜¯åœ¨è¾“å…¥é”™è¯¯çš„æ—¶å€™æ‰è¿™æ ·åšã€‚ä¾‹å¦‚ â€˜==â€™ è¾“å…¥æˆ â€˜=â€™ã€‚<br>å¦‚æœæŠŠè¿”å›å€¼æ ‡æ³¨ä¸ºconst å°±å¯ä»¥åœ¨ç¼–è¾‘é˜¶æ®µå‘ç°å¯èƒ½æ½œåœ¨çš„é€»è¾‘é”™è¯¯ã€‚</p>
<h2 id="5ã€const-å‚æ•°"><a href="#5ã€const-å‚æ•°" class="headerlink" title="5ã€const å‚æ•°"></a>5ã€const å‚æ•°</h2><p>é™¤éä½ æœ‰éœ€è¦æ”¹åŠ¨çš„å‚æ•°æˆ–localå¯¹è±¡ï¼Œå¦åˆ™è¯·å°†å®ƒä»¬å£°æ˜ä¸ºconstã€‚</p>
<h2 id="6ã€const-æˆå‘˜å‡½æ•°"><a href="#6ã€const-æˆå‘˜å‡½æ•°" class="headerlink" title="6ã€const æˆå‘˜å‡½æ•°"></a>6ã€const æˆå‘˜å‡½æ•°</h2><p>å°†cosntå®æ–½äºæˆå‘˜å‡½æ•°çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ç¡®ä¿è¯¥æˆå‘˜å‡½æ•°å¯ä½œç”¨äºconstå¯¹è±¡ã€‚<br>1ã€ä»–ä»¬ä½¿classæ¥å£æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚æ˜ç¡®äº†å“ªä¸ªå‡½æ•°å¯ä»¥æ”¹åŠ¨å¯¹è±¡å†…å®¹ï¼Œè€Œå“ªä¸ªå‡½æ•°ä¸è¡Œã€‚<br>2ã€ä»–ä»¬ä½¿â€æ“ä½œconstå¯¹è±¡â€æˆä¸ºå¯èƒ½ã€‚C++æé«˜ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ ¹æœ¬åŠæ³•æ˜¯ä»¥pass by reference-to-constæ–¹å¼ä¼ é€’å¯¹è±¡ã€‚æ­¤æŠ€æœ¯å¯è¡Œçš„å‰ææ˜¯ï¼Œæˆ‘ä»¬æœ‰constæˆå‘˜å‡½æ•°å¯ç”¨æ¥å–å¾—ï¼ˆå¹¶ç»ä¿®é¥°è€Œæˆï¼‰çš„constå¯¹è±¡ã€‚</p>
<p>ä¸€ä¸ªäº‹å®ï¼šä¸¤ä¸ªæˆå‘˜å‡½æ•°å¦‚æœåªæ˜¯å¸¸é‡æ€§ï¼ˆconstnessï¼‰ ä¸åŒï¼Œå¯ä»¥è¢«é‡è½½ã€‚è¿™æ˜¯C++ä¸€æ€»è¦ç‰¹æ€§<br>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class TextBlock &#123;</span><br><span class="line">public:</span><br><span class="line">Â·Â·Â·</span><br><span class="line">  &#x2F;&#x2F;operator[] for const å¯¹è±¡</span><br><span class="line">  const char&amp; operator[](std::size_t position) const &#123;</span><br><span class="line">    return text[position];</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;operator[] for non-const å¯¹è±¡</span><br><span class="line">   char&amp; operator[](std::size_t position) &#123;</span><br><span class="line">    return text[position];</span><br><span class="line">  &#125;</span><br><span class="line">private:</span><br><span class="line">  std::string text;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TextBlock çš„ operator[]s å¯ä»¥è¿™ä¹ˆä½¿ç”¨ï¼š</span><br><span class="line">TextBlock tb&#123;&quot;Hello&quot;&#125;;</span><br><span class="line">std::const &lt;&lt; tb[0];    &#x2F;&#x2F;è°ƒç”¨ non-const TextBlock::operator[]</span><br><span class="line">const TextBlock ctb(&quot;World&quot;);</span><br><span class="line">std::const &lt;&lt; ctb[0];    &#x2F;&#x2F;è°ƒç”¨const TextBlock::operator[]</span><br></pre></td></tr></table></figure>
<p>é™„å¸¦ä¸€æï¼ŒçœŸå®ç¨‹åºä¸­ const å¯¹è±¡å¤§å¤šæ•°ç”¨äºpassed by pointer-to-const æˆ– passed by reference-to-constçš„ä¼ é€’ç»“æœ.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">void print(const TextBlock&amp; ctb) &#123;</span><br><span class="line">  std::cout &lt;&lt; ctb[0];    &#x2F;&#x2F;è°ƒç”¨ const TextBlock::operator[]</span><br><span class="line">    Â·Â·Â·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åªè¦é‡è½½operator[]å¹¶å¯¹ä¸åŒçš„ç‰ˆæœ¬ç»™äºˆä¸åŒçš„è¿”å›ç±»å‹ï¼Œå°±å¯ä»¥ä»¤constå’Œ no-const TextBlocks è·å¾—ä¸åŒçš„å¤„ç†ï¼š<br>std::cout &lt;&lt; tb[0];    //æ²¡é—®é¢˜â€“è¯»ä¸€ä¸ªnon-const TextBlock<br>tb[0] = â€˜xâ€™;              //æ²¡é—®é¢˜â€“å†™ä¸€ä¸ªnon-const TextBlock<br>std::cout &lt;&lt; ctb[0];  //æ²¡é—®é¢˜â€“è¯»ä¸€ä¸ªconst TextBlock<br>ctb[0] = â€˜xâ€™;            //é”™è¯¯â€“å†™ä¸€ä¸ªconst TextBlock</p>
<p>ä¸Šè¿°ä¾‹å­ï¼Œoperator[] è°ƒç”¨åŠ¨ä½œæœ¬èº«æ²¡æœ‰é—®é¢˜ã€‚é”™è¯¯èµ·å› äºä¼å›¾å¯¹äºä¸€ä¸ªâ€ç”±const ç‰ˆçš„operator[]è¿”å›â€çš„const char&amp; å®æ–½èµ‹å€¼ã€‚</p>
<p>ä¹Ÿè¯·æ³¨æ„ï¼Œnon-const operator[] è¿”å›çš„ç±»å‹æ˜¯ä¸€ä¸ª reference to char,è€Œä¸æ˜¯char.<br>å¦‚æœ operator[]åªæ˜¯è¿”å›ä¸€ä¸ªcharï¼Œä¸‹é¢è¿™æ ·çš„è¯­å¥æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tb[0] &#x3D; &#39;x&#39;;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœå‡½æ•°çš„è¿”å›ç±»å‹æ˜¯ä¸ªå†…ç½®ç±»å‹ï¼Œé‚£ä¹ˆæ”¹åŠ¨å‡½æ•°è¿”å›å€¼ä»æ¥å°±ä¸åˆæ³•ã€‚çºµä½¿åˆæ³•ï¼ŒC++ä»¥by valueè¿”å›å¯¹è±¡è¿™ä¸€äº‹å®æ„å‘³ç€è¢«æ”¹åŠ¨çš„å…¶å®æ˜¯ tb.text[0]çš„ä¸€ä¸ªå‰¯æœ¬ã€‚è€Œä¸æ˜¯tb.text[0]è‡ªèº«ã€‚</p>
<p>æˆå‘˜å‡½æ•°å¦‚æœæ˜¯constæ„å‘³ç€ä»€ä¹ˆï¼Ÿ<br>è¿™é‡Œæœ‰ä¸¤ä¸ªæ¦‚å¿µï¼šbitwise constnessï¼ˆåˆç§° physical constnessï¼‰ å’Œ logical constness.<br>bitwise const é˜µè¥çš„äººè®¤ä¸ºï¼Œæˆå‘˜å‡½æ•°ä¹‹ååœ¨ä¸æ›´æ”¹å¯¹è±¡çš„ä»»ä½•æˆå‘˜å˜é‡ï¼ˆstaticé™¤å¤–ï¼‰æ—¶æ‰å¯ä»¥è¯´æ˜¯constã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒä¸æ›´æ”¹å¯¹è±¡å†…çš„ä»»ä½•ä¸€ä¸ªbitã€‚è¿™ç§è®ºç‚¹çš„å¥½å¤„æ˜¯å®¹æ˜“ä¾¦æµ‹åç‚¹ï¼šç¼–è¯‘å™¨åªéœ€è¦å¯»æ‰¾æˆå‘˜å˜é‡çš„èµ‹å€¼åŠ¨ä½œå³å¯ã€‚bitwise constnessæ­£æ˜¯C++å¯¹å¸¸é‡æ€§ï¼ˆconstnessï¼‰çš„å®šä¹‰ï¼Œå› æ­¤const æˆå‘˜å‡½æ•°ä¸å¯ä»¥æ›´æ”¹å¯¹è±¡å†…ä»»ä½•non-static æˆå‘˜å˜é‡ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯è®¸å¤šæˆå‘˜å‡½æ•°è™½ç„¶ä¸å…·å¤‡constæ€§è´¨å´èƒ½é€šè¿‡bitwise æµ‹è¯•ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œä¸€ä¸ªæ›´æ”¹äº†â€æŒ‡é’ˆæ‰€æŒ‡ç‰©â€çš„æˆå‘˜å‡½æ•°è™½ç„¶ä¸èƒ½ç®—æ˜¯const,ä½†å¦‚æœåªå…·æœ‰æŒ‡é’ˆï¼ˆè€Œéå…¶æ‰€æŒ‡ç‰©ï¼‰éš¶å±äºå¯¹è±¡ï¼Œé‚£ä¹ˆç§°æ­¤å‡½æ•°ä¸ºbitwise const ä¸ä¼šå¼•å‘ç¼–è¯‘å™¨å¼‚è®®ã€‚è¿™å¯¼è‡´åç›´è§‚ç»“æœã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªTextBlock-lick classï¼Œå®ƒå°†æ•°æ®å­˜å‚¨ä¸ºchar* è€Œä¸æ˜¯string,å› ä¸ºå®ƒéœ€è¦å’Œä¸€ä¸ªä¸è®¤è¯†stringå¯¹è±¡çš„ C APIæ²Ÿé€šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class CTextBlock &#123;</span><br><span class="line">public:</span><br><span class="line">Â·Â·Â·</span><br><span class="line">  &#x2F;&#x2F;bitwise const å£°æ˜ï¼Œä½†å…¶å®ä¸é€‚å½“</span><br><span class="line">  char&amp; operator[](std::size_t position) const &#123;</span><br><span class="line">    return pText[position];</span><br><span class="line">  &#125;</span><br><span class="line">private:</span><br><span class="line">  char* pText;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªclassä¸é€‚å½“çš„å°†å…¶operator[] å£°æ˜ä¸ºconstæˆå‘˜å‡½æ•°ï¼Œè€Œè¯¥å‡½æ•°å´è¿”å›ä¸€ä¸ª reference æŒ‡å‘å¯¹è±¡å†…éƒ¨å€¼ï¼ˆæ¡æ¬¾28æœ‰æ·±åˆ»è®¨è®ºï¼‰ã€‚å‡è®¾æš‚æ—¶ä¸ç®¡è¿™ä¸ªäº‹å®ï¼Œè¯·æ³¨æ„ï¼Œoperator[]å®ç°ä»£ç å¹¶ä¸æ›´æ”¹pText.äºæ˜¯ç¼–è¯‘å™¨å¾ˆå¼€å¿ƒæ»´ä¸ºoperator[]äº§å‡ºç›®æ ‡ä»£ç ã€‚ä»–æ˜¯bitwise constï¼Œæ‰€æœ‰ç¼–è¯‘å™¨éƒ½è¿™ä¹ˆè®¤å®šã€‚ä½†æ˜¯çœ‹çœ‹å®ƒå…è®¸å‘ç”Ÿä»€ä¹ˆäº‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const CTextBlock cctb(&quot;Hello&quot;);  &#x2F;&#x2F;  å£°æ˜ä¸€ä¸ªå¸¸é‡å¯¹è±¡</span><br><span class="line">char* pc &#x3D; &amp;cctb[0];                  &#x2F;&#x2F;è°ƒç”¨ const operator[] å–å¾—ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘cctb æ•°æ®</span><br><span class="line">*pc &#x3D; &quot;J&quot;;                                &#x2F;&#x2F;cctb ç°åœ¨æœ‰äº†&quot;Jello&quot;è¿™æ ·çš„å†…å®¹</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå½“ç„¶ä¸è¯¥æœ‰ä»»ä½•é”™è¯¯ï¼šä½ åˆ›å»ºä¸€ä¸ªå¸¸é‡å¯¹è±¡å¹¶è®¾ä»¥æŸå€¼ï¼Œè€Œä¸”åªå¯¹å®ƒè°ƒç”¨äº†constæˆå‘˜å‡½æ•°ã€‚ä½†ä½ ç»ˆç©¶è¿˜æ˜¯æ”¹å˜äº†å®ƒçš„å€¼ã€‚</p>
<p>è¿™ç§æƒ…å†µå¯¼å‡ºæ‰€è°“çš„ logical constnessã€‚è¿™ä¸€æ´¾æ‹¥æŠ¤è€…ä¸»å¼ ï¼Œä¸€ä¸ªconstæˆå‘˜å‡½æ•°å¯ä»¥ä¿®æ”¹å®ƒæ‰€å¤„ç†çš„å¯¹è±¡å†…çš„æŸäº›bits,ä½†åªæœ‰åœ¨å®¢æˆ·ç«¯ä¾¦æµ‹ä¸å‡ºçš„æƒ…å†µä¸‹æ‰å¾—å¦‚æ­¤ã€‚ä¾‹å¦‚ä½ çš„CTextBlock class æœ‰å¯èƒ½é«˜é€Ÿç¼“å­˜ï¼ˆcacheï¼‰æ–‡æœ¬åŒºå—çš„é•¿åº¦ä»¥ä¾¿åº”ä»˜è¯¢é—®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class CTextBlcok &#123;</span><br><span class="line">public:</span><br><span class="line">  std::size_t length() const;</span><br><span class="line">private:</span><br><span class="line">  char *pText;</span><br><span class="line">  std::size_t textLength;  &#x2F;&#x2F;æœ€è¿‘ä¸€æ¬¡è®¡ç®—çš„æ–‡æœ¬åŒºå—é•¿åº¦</span><br><span class="line">  bool lengthIsValid;      &#x2F;&#x2F; ç›®å‰é•¿åº¦æ˜¯å¦æœ‰æ•ˆ</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::siez_t CTextBlock::length() const &#123;</span><br><span class="line">  if(!lengthIsValid) &#123;</span><br><span class="line">    textLength &#x3D; std::strlen(pText);</span><br><span class="line">    textIsValid &#x3D; true;</span><br><span class="line">  &#125;</span><br><span class="line">  return textLength;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>length çš„å®ç°å½“ç„¶ä¸æ˜¯bitwise const ,å› ä¸º textLength å’Œ lengthIsValidéƒ½å¯èƒ½è¢«ä¿®æ”¹ã€‚è¿™ä¸¤ç¬”æ•°æ®è¢«ä¿®æ”¹å¯¹  const CTextBlockå¯¹è±¡è€Œè¨€è™½ç„¶å¯æ¥å—ï¼Œä½†ç¼–è¯‘å™¨ä¸ç»Ÿä¸€ã€‚ä»–ä»¬åšæŒbitwise constness.æ€ä¹ˆåŠï¼Ÿ<br>è§£å†³åŠæ³•å¾ˆç®€å•ï¼šåˆ©ç”¨C++çš„ä¸€ä¸ªä¸cosntç›¸å…³çš„æ‘†åŠ¨åœºï¼šmutable(å¯å˜çš„)ã€‚<br>mutableé‡Šæ”¾æ‰non-staticæˆå‘˜å˜é‡çš„bitwise constnessçº¦æŸï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class CTextBlck &#123;</span><br><span class="line">public:</span><br><span class="line"> Â·Â·Â·</span><br><span class="line">  static::size_t length() cosnt;</span><br><span class="line">private:</span><br><span class="line">char* pText;</span><br><span class="line">mutable std::size_t textLength;    &#x2F;&#x2F;è¿™äº›æˆå‘˜å˜é‡å¯èƒ½æ€»æ˜¯ä¼šè¢«æ›´æ”¹ï¼Œå³ä½¿åœ¨constæˆå‘˜å‡½æ•°å†…</span><br><span class="line">mutable bool lengthIsValid;          </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::size_t CTextBlock::length() const &#123;</span><br><span class="line">  if(!lengthIsValid) &#123;</span><br><span class="line">    textLength &#x3D; std::strlen(pText);  &#x2F;&#x2F;  ç°åœ¨ï¼Œå¯ä»¥è¿™æ ·ï¼Œä¹Ÿå¯ä»¥è¿™æ ·</span><br><span class="line">    lengthIsValid &#x3D; true;  </span><br><span class="line">  &#125;</span><br><span class="line">  return textLength;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7ã€ä¸ºé¿å…ä»£ç é‡å¤ï¼Œåˆ©ç”¨const-å‡½æ•°è°ƒç”¨-non-const-å‡½æ•°ï¼Œä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœ"><a href="#7ã€ä¸ºé¿å…ä»£ç é‡å¤ï¼Œåˆ©ç”¨const-å‡½æ•°è°ƒç”¨-non-const-å‡½æ•°ï¼Œä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœ" class="headerlink" title="7ã€ä¸ºé¿å…ä»£ç é‡å¤ï¼Œåˆ©ç”¨const å‡½æ•°è°ƒç”¨ non-const å‡½æ•°ï¼Œä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœ"></a>7ã€ä¸ºé¿å…ä»£ç é‡å¤ï¼Œåˆ©ç”¨const å‡½æ•°è°ƒç”¨ non-const å‡½æ•°ï¼Œä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœ</h2><p>mutableå¯ä»¥è§£å†³ä¸€äº› constå†…éƒ¨æ— æ³•æ”¹å˜æˆå‘˜å˜é‡çš„é—®é¢˜ã€‚ä½†æ˜¯å¹¶éèƒ½è§£å†³æ‰€æœ‰éš¾é¢˜ã€‚<br>å‡å¦‚TextBlock å’Œ CTextBlock å†…çš„operato[] ä¸åªæ˜¯è¿”å›ä¸€ä¸ªreferenceæŒ‡å‘æŸå­—ç¬¦ï¼Œä¹Ÿæ‰§è¡Œè¾¹ç•Œæ£€æŸ¥ï¼ˆbounds checkingï¼‰ã€æ—¥å¿—è®¿é—®ä¿¡æ¯ï¼ˆlogged access info.ï¼‰ã€ç”šè‡³å¯èƒ½è¿›è¡Œå®Œæ•´æ€§æ£€éªŒã€‚æŠŠæ‰€æœ‰è¿™äº›åŒæ—¶æ”¾è¿›const å’Œ non-const operator[]ä¸­ï¼Œè¿™æ ·è™½ç„¶ä¸è¢«æå€¡ï¼Œä½†æ˜¯ç¡®å®æ˜¯å­˜åœ¨çš„é—®é¢˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class TextBlock &#123;</span><br><span class="line">public: </span><br><span class="line">Â·Â·Â·</span><br><span class="line">  const char&amp; operator[](std::size_t position) const &#123;</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;è¾¹ç•Œæ£€æŸ¥  (bounds checking)</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;æ—¥å¿—è®¿é—®æ•°æ®  (log access data)</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;æ•°æ®å®Œæ•´è¡ŒéªŒè¯ (verify data integrity)</span><br><span class="line">    return text[position];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  char&amp; operator[](std::size_t position) const &#123;</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;è¾¹ç•Œæ£€æŸ¥  (bounds checking)</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;æ—¥å¿—è®¿é—®æ•°æ®  (log access data)</span><br><span class="line">    Â·Â·Â·&#x2F;&#x2F;æ•°æ®å®Œæ•´è¡ŒéªŒè¯ (verify data integrity)</span><br><span class="line">    return text[position];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">  std::string text;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä»£ç å°±å¾ˆæ£’ï¼Œå“¦ä¸ï¼Œå°±å¤ªå†—ä½™äº†ã€‚<br>æˆ‘ä»¬æƒ³åšåˆ° å®ç°operator[] ä¸€æ¬¡ï¼Œå¹¶èƒ½ä½¿ç”¨å®ƒä¸¤æ¬¡ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»æ˜¯å…¶ä¸­ä¸€ä¸ªè°ƒç”¨å¦ä¸€ä¸ªã€‚<br>è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨åˆ°å°†å¸¸é‡æ€§ç§»é™¤ï¼ˆcasting away constnessï¼‰<br>å°±ä¸€èˆ¬å®ˆåˆ™è€Œè¨€ï¼Œè½¬å‹ï¼ˆcastingï¼‰æ˜¯ä¸€ä¸ªç³Ÿç³•çš„æƒ³æ³•ï¼Œã€æ¡æ¬¾27ä¸“é—¨è®²å¼ºåˆ¶è½¬æ¢ã€‘<br>ä½†æ˜¯è¿™é‡Œä¸ºäº†å‡å°‘ä»£ç å†—ä½™ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨castingäº†ã€‚</p>
<p>æˆ‘ä»¬åº”è¯¥è®©const operator[] å®Œå…¨åšæ‰ non-constç‰ˆæœ¬è¯¥åšçš„ä¸€åˆ‡ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å…¶è¿”å›ç±»å‹å¤šäº†ä¸€ä¸ªconst èµ„æ ¼ä¿®é¥°ã€‚<br>è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœå°†è¿”å›å€¼çš„const è½¬é™¤æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºä¸è®ºè°è°ƒç”¨ non-const operator[] éƒ½ä¸€å®šé¦–å…ˆæœ‰ä¸€ä¸ª non-const å¯¹è±¡ï¼Œå¦åˆ™å°±ä¸èƒ½å¤Ÿè°ƒç”¨non-const å‡½æ•°ã€‚æ‰€ä»¥ ä»¤ non-const operator[]  è°ƒç”¨å…¶const å…„å¼Ÿæ˜¯ä¸€ä¸ªé¿å…ä»£ç é‡å¤çš„å®‰å…¨åšæ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class TextBlock &#123;</span><br><span class="line">public:</span><br><span class="line">Â·Â·Â·</span><br><span class="line">  const char&amp; operator[] (std::size_t position) const &#123;</span><br><span class="line">    Â·Â·Â·</span><br><span class="line">    Â·Â·Â·</span><br><span class="line">    Â·Â·Â·</span><br><span class="line">    return text[position];</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;å°†op[]è¿”å›å€¼çš„constè½¬é™¤ ä¸º*this åŠ ä¸Š const è°ƒç”¨ const op[]</span><br><span class="line">  char&amp; operator[](std::size_t position) &#123;</span><br><span class="line">    return const_cast&lt;char &amp;&gt;(</span><br><span class="line">      static_cast&lt;const TextBlock&gt;(*this)[position]</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  Â·Â·Â·</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™ä»½ä»£ç æœ‰ä¸¤ä¸ªè½¬å‹åŠ¨ä½œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªã€‚<br>æˆ‘ä»¬æ‰“ç®—è®© non-const operator[]  è°ƒç”¨å…¶ constå…„å¼Ÿï¼Œä½† non-const operator[] å†…éƒ¨è‹¥åªæ˜¯å•çº¯è°ƒç”¨ operato[],ä¼šé€’å½’è°ƒç”¨è‡ªå·±ã€‚<br>ä¸ºäº†é¿å…æ— ç©·é€’å½’ï¼Œæˆ‘ä»¬å¿…é¡»æ˜ç¡®æŒ‡å‡ºè°ƒç”¨çš„æ˜¯ const operator[], ä½†C++ç¼ºä¹ç›´æ¥çš„è¯­æ³•å¯ä»¥é‚£ä¹ˆåšã€‚ å› æ­¤è¿™é‡Œå°† *this ä»å…¶åŸå§‹ç±»å‹ TextBlock&amp; è½¬å‹ä¸º cosnt TextBlock&amp;ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨è½¬å‹æ“ä½œä¸ºä»–åŠ ä¸Šconstã€‚ æ‰€ä»¥è¿™é‡Œå…±ä¸¤æ¬¡è½¬å‹ï¼š<br>ç¬¬ä¸€æ¬¡ç”¨æ¥ä¸º *this æ·»åŠ  const( è¿™ä½¿å¾—è°ƒç”¨ operator[] æ—¶å¾—ä»¥è°ƒç”¨ const ç‰ˆæœ¬)ï¼Œ<br>ç¬¬äºŒæ¬¡åˆ™æ˜¯ä» const operator[] çš„è¿”å›å€¼ä¸­ç§»é™¤ const.</p>
<p>æ·»åŠ const çš„é‚£æ¬¡è½¬å‹å¼ºè¿«è¿›è¡Œäº†ä¸€æ¬¡å®‰å…¨è½¬å‹ï¼ˆå°† non-const å¯¹è±¡è½¬ä¸º const å¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ static_cosntã€‚ç§»é™¤constçš„é‚£ä¸ªåŠ¨ä½œåªå¯ä»¥ç±ç”±const_cast å®Œæˆï¼Œæ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼ˆå°±æŠ€æœ¯è€Œè¨€å…¶å®æ˜¯æœ‰çš„ï¼šä¸€ä¸ª C-styleè½¬å‹ä¹Ÿè¡Œå¾—é€šï¼‰</p>
<p>æˆ‘ä»¬ä¸åº”è¯¥ç”¨ const ç‰ˆæœ¬è°ƒç”¨ non-constç‰ˆæœ¬ã€‚è¿™è¿åäº†constçš„è®¾è®¡æœ¬æ„ï¼Œ const æˆå‘˜å‡½æ•°æ‰¿è¯ºç»ä¸æ”¹å˜å¯¹è±¡çš„é€»è¾‘çŠ¶æ€ã€‚non-constå‡½æ•°æ²¡æœ‰è¿™ç§çº¦æŸã€‚</p>

    </div>

    
    
    
      <div>
        
          <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æ„Ÿè°¢æ‚¨çš„é˜…è¯»<i class="fa fa-flag"></i>æ¬¢è¿è®¨è®º-------------</div>
    
</div>
        
      </div>
      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/effective-C/" rel="tag"># effective C++</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/11/13/Effective-C-%E6%9D%A1%E6%AC%BE02-%E5%B0%BD%E9%87%8F%E4%BB%A5const-enum-inline-%E6%9B%BF%E6%8D%A2-define/" rel="prev" title="Effective C++ æ¡æ¬¾02: å°½é‡ä»¥const, enum, inline æ›¿æ¢#define">
      <i class="fa fa-chevron-left"></i> Effective C++ æ¡æ¬¾02: å°½é‡ä»¥const, enum, inline æ›¿æ¢#define
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/11/26/Effective-C-%E6%9D%A1%E6%AC%BE04-%E7%A1%AE%E5%AE%9A%E5%AF%B9%E8%B1%A1%E8%A2%AB%E4%BD%BF%E7%94%A8%E5%89%8D%E5%B7%B2%E5%85%88%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96/" rel="next" title="Effective C++ æ¡æ¬¾04:ç¡®å®šå¯¹è±¡è¢«ä½¿ç”¨å‰å·²å…ˆè¢«åˆå§‹åŒ–">
      Effective C++ æ¡æ¬¾04:ç¡®å®šå¯¹è±¡è¢«ä½¿ç”¨å‰å·²å…ˆè¢«åˆå§‹åŒ– <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Effective-C-%E6%9D%A1%E6%AC%BE03-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8const"><span class="nav-number">1.</span> <span class="nav-text">Effective C++ æ¡æ¬¾03:å°½å¯èƒ½ä½¿ç”¨const</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81const-%E5%85%81%E8%AE%B8%E4%BD%A0%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E8%AF%AD%E4%B9%89%E7%BA%A6%E6%9D%9F%EF%BC%8C%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E4%B8%8D%E8%AF%A5%E8%A2%AB%E6%94%B9%E5%8A%A8%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.1.</span> <span class="nav-text">1ã€const å…è®¸ä½ æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼ŒæŒ‡å®šä¸€ä¸ªä¸è¯¥è¢«æ”¹åŠ¨çš„å¯¹è±¡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81const-%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%9C%A8%E5%93%AA%E9%87%8C"><span class="nav-number">1.2.</span> <span class="nav-text">2ã€const å¯ä»¥ç”¨åœ¨å“ªé‡Œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81STL%E8%BF%AD%E4%BB%A3%E5%99%A8-const"><span class="nav-number">1.3.</span> <span class="nav-text">3ã€STLè¿­ä»£å™¨ const</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81const-%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">1.4.</span> <span class="nav-text">4ã€const è¿”å›å€¼</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%E3%80%81const-%E5%8F%82%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">5ã€const å‚æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6%E3%80%81const-%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-number">1.6.</span> <span class="nav-text">6ã€const æˆå‘˜å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7%E3%80%81%E4%B8%BA%E9%81%BF%E5%85%8D%E4%BB%A3%E7%A0%81%E9%87%8D%E5%A4%8D%EF%BC%8C%E5%88%A9%E7%94%A8const-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8-non-const-%E5%87%BD%E6%95%B0%EF%BC%8C%E4%BB%A5%E8%BE%BE%E5%88%B0%E5%A4%8D%E7%94%A8%E7%9A%84%E6%95%88%E6%9E%9C"><span class="nav-number">1.7.</span> <span class="nav-text">7ã€ä¸ºé¿å…ä»£ç é‡å¤ï¼Œåˆ©ç”¨const å‡½æ•°è°ƒç”¨ non-const å‡½æ•°ï¼Œä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæœ</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jarvis"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Jarvis</p>
  <div class="site-description" itemprop="description">å¹²é¥­ç¡è§‰æ’¸ä»£ç </div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://www.github.com/wjwdive" title="GitHub â†’ https:&#x2F;&#x2F;www.github.com&#x2F;wjwdive" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jarvissky@163.com" title="E-Mail â†’ mailto:jarvissky@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">null </a>
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2021009233" rel="noopener" target="_blank">æ²ªICPå¤‡2021009233å·-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jarvis</span>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">50k</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'MXtrA2biGG8FzjWmPUUrCXPl-9Nh9j0Va',
      appKey     : '5ABrVsKIAfCv40vYhWRu5E9f',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
